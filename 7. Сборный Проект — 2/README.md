# Технологический процесс получения золота из руды

## Этапы процесса

1. **Флотация**  
   - Исходная дроблёная смесь золотосодержащей руды подаётся во флотационную установку (float banks).  
   - После обогащения получают:  
     - **Черновой концентрат золота (rougher Au)**  
     - **Отвальные хвосты (rougher tails)** — остатки с низкой концентрацией ценных металлов.  
   - Процесс чувствителен к физико-химическому состоянию флотационной пульпы.

2. **Двухэтапная очистка**  
   - Черновой концентрат проходит две стадии очистки:  
     - Первичная очистка (primary_cleaner)  
     - Вторичная очистка (secondary_cleaner)  
   - Итог — финальный концентрат золота (final Au) и новые отвальные хвосты.

## Важные параметры

- **Rougher feed** — исходное сырьё.  
- **Rougher additions (reagent additions):**  
  - Xanthate — ксантогенат (активатор флотации)  
  - Sulphate — сульфат (на данном производстве сульфид натрия)  
  - Depressant — депрессант (силикат натрия)  
- Параметры процесса:  
  - air amount — объём воздуха  
  - fluid levels — уровень жидкости  
  - feed size — размер гранул сырья  
  - feed rate — скорость подачи

## Наименования признаков

Формат:  
`[этап].[тип_параметра].[название_параметра]`

- **Этапы:**  
  - rougher — флотация  
  - primary_cleaner — первичная очистка  
  - secondary_cleaner — вторичная очистка  
  - final — финальные характеристики

- **Типы параметров:**  
  - input — параметры сырья  
  - output — параметры продукта  
  - state — состояние этапа  
  - calculation — расчётные характеристики

## Расчёт эффективности обогащения (Recovery)

$$
Recovery = \frac{C \times (F - T)}{F \times (C - T)} \times 100\%
$$

где:  
- $C$ — доля золота в концентрате (после флотации/очистки)  
- $F$ — доля золота в сырье или концентрате до процесса  
- $T$ — доля золота в отвальных хвостах (после процесса)

## Метрика качества — sMAPE

Symmetric Mean Absolute Percentage Error (симметричное среднее абсолютное процентное отклонение):

$$
sMAPE = \frac{1}{N} \sum_{i=1}^N \frac{|y_i - \hat{y}_i|}{(|y_i| + |\hat{y}_i|)/2} \times 100\%
$$

где:  
$y_i$ — истинное значение  
$\hat{y}_i$ — предсказание  
$N$ — количество объектов  

## Задача моделирования

- Необходимо подготовить прототип модели машинного обучения для компании **«Цифра»**, разрабатывающей решения для эффективной работы промышленных предприятий.  
- Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды, используя данные с параметрами добычи и очистки.  
- Цель модели — помочь оптимизировать производство и предотвратить запуск с убыточными характеристиками.

- Прогнозировать две величины:  
  - Эффективность обогащения чернового концентрата — `rougher.output.recovery`  
  - Эффективность обогащения финального концентрата — `final.output.recovery`

- Итоговая метрика качества:  

$$
sMAPE_{\text{итог}} = 0.25 \times sMAPE_{\text{rougher}} + 0.75 \times sMAPE_{\text{final}}
$$

## Данные

- `gold_recovery_train_new.csv` — обучающая выборка  
- `gold_recovery_test_new.csv` — тестовая выборка  
- `gold_recovery_full_new.csv` — исходные данные

## Методы и инструменты, использованные в работе

### Предобработка данных:
- Заполнение пропусков методом ffill.  
- Очистка данных от аномалий.  
- Приведение временных меток к числовому формату.  
- Добавление целевых признаков в тестовую выборку.

### Анализ данных:
- Изучение распределений химических показателей на этапах обогащения.  
- Проверка правильности расчёта эффективности recovery.  
- Анализ пропусков и распределений признаков.

### Визуализация:
- Гистограммы, плотностные графики и временные ряды.

### Моделирование:
- Обучение регрессионных моделей для прогнозирования recovery.  
- Оценка качества через cross_val_score с метрикой sMAPE.  
- Ручной подбор гиперпараметров.

### Инструменты:
Python (pandas, matplotlib, seaborn, scikit-learn)

---

**Кратко:**  
Работа выполнена методами разведочного анализа данных (EDA), статистического анализа и построения моделей с кросс-валидацией. Для оценки моделей использован метод `cross_val_score`, а не `GridSearchCV`, поскольку последний ещё не изучался в рамках обучения. Я выбрал более простой и понятный инструмент, чтобы не вводить в заблуждение — не создавать иллюзий по поводу уверенного владения более сложным методом. Изучение `GridSearchCV` и подбора гиперпараметров запланировано в курсе Яндекс.Практикум «Специалист по Data Science».
